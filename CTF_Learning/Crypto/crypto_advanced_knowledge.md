# 🔒 密码学进阶知识体系

## 🎯 学习目标
- 深入理解现代密码学原理
- 掌握CTF中常见的密码学攻击技术
- 熟练使用密码学分析工具
- 具备独立分析和破解密码学题目的能力

## 📚 核心知识体系

### 1. 数论基础

#### 基本概念
```
1. 整除与同余:
   - 整除: a|b 表示存在整数k使得b=ka
   - 同余: a≡b(mod n) 表示n|(a-b)
   - 同余类: 模n的剩余类

2. 最大公约数:
   - 欧几里得算法: gcd(a,b) = gcd(b, a mod b)
   - 扩展欧几里得算法: ax + by = gcd(a,b)
   - 贝祖等式: 求解线性丢番图方程

3. 模运算:
   - 加法: (a+b) mod n = ((a mod n) + (b mod n)) mod n
   - 乘法: (a*b) mod n = ((a mod n) * (b mod n)) mod n
   - 幂运算: 快速幂算法

4. 模逆元:
   - 定义: 若gcd(a,n)=1，则存在b使得ab≡1(mod n)
   - 求解: 扩展欧几里得算法
   - 费马小定理: 若p为质数，则a^(p-1)≡1(mod p)
```

#### 重要定理
```
1. 中国剩余定理(CRT):
   条件: n1,n2,...,nk两两互质
   方程组: x≡a1(mod n1), x≡a2(mod n2), ..., x≡ak(mod nk)
   解: x = Σ(ai * Mi * yi) mod N
   其中: N = n1*n2*...*nk, Mi = N/ni, yi是Mi模ni的逆元

2. 费马小定理:
   若p为质数，a不被p整除，则a^(p-1)≡1(mod p)
   推论: a^p≡a(mod p)

3. 欧拉定理:
   若gcd(a,n)=1，则a^φ(n)≡1(mod n)
   其中φ(n)是欧拉函数

4. 卡迈克尔定理:
   对于任意a，都有a^λ(n)≡1(mod n)
   其中λ(n)是卡迈克尔函数
```

### 2. RSA密码系统

#### RSA基础
```
1. 密钥生成:
   - 选择两个大质数p, q
   - 计算n = p * q
   - 计算φ(n) = (p-1)(q-1)
   - 选择e，满足gcd(e, φ(n)) = 1
   - 计算d，满足ed ≡ 1 (mod φ(n))
   - 公钥: (n, e)，私钥: (n, d)

2. 加密解密:
   - 加密: c ≡ m^e (mod n)
   - 解密: m ≡ c^d (mod n)

3. 数字签名:
   - 签名: s ≡ m^d (mod n)
   - 验证: m ≡ s^e (mod n)
```

#### RSA攻击技术
```
1. 小指数攻击:
   低加密指数攻击(e=3):
   - 当m^e < n时，直接开e次方根
   - 多个接收者攻击: 中国剩余定理恢复明文
   - Coppersmith攻击: 部分已知明文

   低解密指数攻击:
   - Wiener攻击: d < n^0.25时有效
   - Boneh-Durfee攻击: d < n^0.292时有效

2. 模数分解攻击:
   Pollard's rho算法:
   - 适用于小因子分解
   - 时间复杂度O(√p)

   Pollard's p-1算法:
   - 当p-1有小因子时有效
   - 选择合适的底数进行攻击

   二次筛法:
   - 大整数分解算法
   - 寻找平方同余关系

   椭圆曲线分解法:
   - ECM算法
   - 对中等大小因子有效

3. 共模攻击:
   条件: 相同模数n，不同公钥e1, e2
   要求: gcd(e1, e2) = 1
   方法: 扩展欧几里得算法求解

4. 选择密文攻击:
   条件: 可以选择密文进行解密
   方法: 构造特殊密文获取信息
   防护: 填充方案(OAEP)

5. 时间攻击:
   原理: 利用解密时间差异
   目标: 恢复私钥信息
   防护: 常数时间算法

6. 侧信道攻击:
   功耗分析: 分析功耗曲线
   电磁泄露: 监听电磁信号
   故障注入: 引入计算错误
```

### 3. 椭圆曲线密码学(ECC)

#### 椭圆曲线基础
```
1. 椭圆曲线方程:
   Weierstrass形式: y² = x³ + ax + b (mod p)
   判别式: Δ = -16(4a³ + 27b²) ≠ 0

2. 点运算:
   点加法: P + Q = R
   - 若P ≠ Q: 斜率k = (y₂-y₁)/(x₂-x₁)
   - 若P = Q: 斜率k = (3x₁²+a)/(2y₁)
   - R = (k²-x₁-x₂, k(x₁-x₃)-y₁)

   标量乘法: kP = P + P + ... + P (k次)
   - 二进制方法
   - 滑动窗口方法
   - Montgomery阶梯

3. 椭圆曲线群:
   - 阿贝尔群结构
   - 无穷远点作为单位元
   - 点的阶和群的阶
```

#### ECC攻击技术
```
1. 离散对数问题:
   问题: 给定P, Q，求k使得Q = kP
   难度: 椭圆曲线离散对数问题(ECDLP)

2. Pohlig-Hellman攻击:
   条件: 群阶有小因子
   方法: 分解到小子群求解
   防护: 选择大质数阶的曲线

3. Smart攻击:
   条件: 曲线阶等于特征数p
   方法: 提升到p-adic数
   影响: 异常曲线不安全

4. MOV攻击:
   条件: 嵌入度较小
   方法: 映射到有限域
   影响: 超奇异曲线不安全

5. 无效曲线攻击:
   方法: 使用错误的曲线参数
   目标: 泄露私钥信息
   防护: 验证点在正确曲线上

6. 扭曲攻击:
   方法: 利用二次扭曲曲线
   条件: 扭曲曲线阶有小因子
   防护: 检查点的合法性
```

### 4. 哈希函数与消息认证

#### 哈希函数基础
```
1. 安全性质:
   单向性: 给定h(x)，难以求出x
   弱抗碰撞: 给定x，难以找到y≠x使得h(x)=h(y)
   强抗碰撞: 难以找到x≠y使得h(x)=h(y)

2. 常见哈希函数:
   MD5: 128位输出，已被破解
   SHA-1: 160位输出，理论上被破解
   SHA-2: SHA-224, SHA-256, SHA-384, SHA-512
   SHA-3: Keccak算法，最新标准

3. 构造方法:
   Merkle-Damgård结构:
   - 迭代压缩函数
   - 长度填充
   - 初始向量

   海绵结构(Sponge):
   - 吸收阶段
   - 挤压阶段
   - 置换函数
```

#### 哈希攻击技术
```
1. 生日攻击:
   原理: 生日悖论
   复杂度: O(2^(n/2))
   应用: 寻找哈希碰撞

2. 长度扩展攻击:
   条件: Merkle-Damgård结构
   方法: 利用内部状态
   影响: HMAC设计考虑

3. 彩虹表攻击:
   原理: 时间空间权衡
   方法: 预计算哈希链
   防护: 加盐哈希

4. 差分攻击:
   方法: 分析输入差分
   目标: 构造碰撞
   应用: MD5, SHA-1破解

5. 侧信道攻击:
   时间攻击: 利用计算时间
   功耗攻击: 分析功耗模式
   缓存攻击: 利用缓存访问
```

### 5. 对称密码算法

#### 分组密码
```
1. DES (Data Encryption Standard):
   结构: Feistel网络
   密钥长度: 56位(实际64位含校验)
   分组长度: 64位
   轮数: 16轮
   弱点: 密钥空间小，已被破解

2. AES (Advanced Encryption Standard):
   结构: SPN网络
   密钥长度: 128, 192, 256位
   分组长度: 128位
   轮数: 10, 12, 14轮
   操作: SubBytes, ShiftRows, MixColumns, AddRoundKey

3. 工作模式:
   ECB (Electronic Codebook):
   - 每个分组独立加密
   - 相同明文产生相同密文
   - 不推荐使用

   CBC (Cipher Block Chaining):
   - 前一个密文块作为IV
   - 需要初始化向量
   - 错误传播

   CFB (Cipher Feedback):
   - 流密码模式
   - 自同步
   - 错误传播

   OFB (Output Feedback):
   - 流密码模式
   - 不自同步
   - 无错误传播

   CTR (Counter):
   - 计数器模式
   - 可并行
   - 随机访问
```

#### 流密码
```
1. RC4:
   结构: 伪随机数生成器
   密钥长度: 40-2048位
   弱点: 密钥调度算法缺陷

2. ChaCha20:
   结构: ARX操作
   密钥长度: 256位
   特点: 高性能，安全性好

3. 线性反馈移位寄存器(LFSR):
   结构: 线性递推关系
   周期: 最大2^n-1
   攻击: Berlekamp-Massey算法
```

#### 对称密码攻击
```
1. 差分密码分析:
   原理: 分析输入输出差分
   方法: 构造差分特征
   应用: DES, AES分析

2. 线性密码分析:
   原理: 寻找线性逼近
   方法: 线性偏差分析
   应用: DES破解

3. 积分攻击:
   原理: 利用代数性质
   方法: 平衡函数分析
   应用: AES简化版

4. 相关密钥攻击:
   条件: 已知密钥关系
   方法: 利用密钥调度
   防护: 独立密钥

5. 侧信道攻击:
   时间攻击: 缓存访问模式
   功耗攻击: DPA, CPA
   故障攻击: DFA
```

### 6. CTF密码学常见题型

#### 古典密码
```
1. 替换密码:
   凯撒密码: 字母表位移
   仿射密码: ax+b变换
   维吉尼亚密码: 多表替换
   Playfair密码: 5×5方格

2. 置换密码:
   栅栏密码: 按行写按列读
   列置换: 密钥控制列序
   路径密码: 特定路径读取

3. 破解方法:
   频率分析: 字母出现频率
   重合指数: 判断密码类型
   卡西斯基测试: 求密钥长度
   暴力破解: 小密钥空间
```

#### 现代密码题型
```
1. RSA相关:
   小指数: e=3, e=65537
   共模攻击: 相同n不同e
   Wiener攻击: 小私钥d
   分解攻击: 特殊n的分解

2. 椭圆曲线:
   弱曲线: 异常曲线
   小子群: Pohlig-Hellman
   无效点: 点不在曲线上
   扭曲攻击: 二次扭曲

3. 哈希函数:
   碰撞攻击: MD5, SHA-1
   长度扩展: Merkle-Damgård
   彩虹表: 预计算攻击
   生日攻击: 概率分析

4. 对称密码:
   ECB模式: 模式缺陷
   密钥复用: 流密码攻击
   填充攻击: PKCS#7
   时间攻击: 实现缺陷
```

## 🛠️ 密码学工具

### 1. 数学计算工具
```
SageMath:
- 强大的数学计算系统
- 内置密码学函数
- 椭圆曲线计算
- 数论算法实现

Mathematica:
- 商业数学软件
- 符号计算能力
- 数值计算精度
- 可视化功能

Python库:
- gmpy2: 大整数运算
- sympy: 符号计算
- pycrypto: 密码学库
- cryptography: 现代密码学
```

### 2. 密码分析工具
```
在线工具:
- CyberChef: 多功能分析
- dcode.fr: 古典密码破解
- factordb.com: 大整数分解
- Alpertron: 数论计算器

专用工具:
- RsaCtfTool: RSA攻击工具
- fcrackzip: ZIP密码破解
- John the Ripper: 密码破解
- Hashcat: GPU加速破解

编程框架:
- Crypto.Util: Python密码学工具
- libnum: 数论函数库
- pwntools: CTF工具包
- z3-solver: 约束求解器
```

### 3. 调试分析工具
```
静态分析:
- IDA Pro: 逆向分析
- Ghidra: 开源逆向
- radare2: 命令行逆向
- Hopper: macOS逆向

动态分析:
- GDB: Linux调试器
- x64dbg: Windows调试器
- Frida: 动态插桩
- Pin: Intel插桩框架

网络分析:
- Wireshark: 协议分析
- tcpdump: 命令行抓包
- Burp Suite: Web代理
- OWASP ZAP: Web扫描
```

## 📝 解题方法论

### 1. 题目分析流程
```
1. 信息收集:
   - 题目描述分析
   - 给定文件检查
   - 算法类型识别
   - 参数范围估计

2. 漏洞识别:
   - 参数安全性检查
   - 实现缺陷分析
   - 数学性质利用
   - 侧信道可能性

3. 攻击方法选择:
   - 理论攻击可行性
   - 计算复杂度评估
   - 工具可用性检查
   - 时间限制考虑

4. 实施攻击:
   - 工具使用或编程实现
   - 参数调优
   - 结果验证
   - 优化改进
```

### 2. 常见解题技巧
```
1. 数学分析:
   - 质因数分解
   - 模运算性质
   - 数论定理应用
   - 代数关系利用

2. 编程实现:
   - 算法正确性
   - 效率优化
   - 精度控制
   - 边界处理

3. 工具使用:
   - 参数配置
   - 结果解释
   - 多工具验证
   - 自动化脚本

4. 逆向分析:
   - 算法识别
   - 参数提取
   - 流程理解
   - 弱点发现
```

这份密码学进阶知识体系涵盖了CTF Crypto方向的核心内容，从数学基础到实际攻击技术，为深入学习密码学安全提供了全面的指导。
